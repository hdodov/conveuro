!function(){"use strict";function r(r){for(var a=[r.selectedText,r.startContainerText,r.endContainerText,r.commonAncestorText],s=null,o=null,t=0;t<a.length;t++)"string"==typeof a[t]&&"number"!=typeof o&&(o=e(a[t]));if("number"==typeof o)for(t=0;t<a.length;t++)"string"==typeof a[t]&&"string"!=typeof s&&(s=n(a[t]));return{currency:s,value:o}}function e(r){var e,n,a=/(\d(?:[\.,\s]?\d+)*)(?:([a-z])\b)?/i.exec(r);return a&&a.length&&(e=l(a[1]),(n=a[2])?c.modifierSymbols.forEach(function(r){n.match(r[0])&&(e*=r[1])}):c.modifierWords.forEach(function(n){r.match(n[0])&&(e*=n[1])})),"number"==typeof e&&NaN!==e?e:null}function n(r){var e=m(function(e,n){return-1!==r.indexOf(n)});if(1===s(e))for(var n in e)return n;var a=m(function(e){var n=0;return e.symbols.forEach(function(e){("string"==typeof e&&-1!==r.indexOf(e)||"object"==typeof e&&e instanceof RegExp&&r.match(e))&&n++}),n>0&&n}),o=m(function(e){var n=0;return e.words.forEach(function(e){r.match(new RegExp(e,"i"))&&n++}),n>0&&n});a=t(a),o=t(o);var l=Object.keys(i(a,o));return(l=l.sort(function(r,e){return y[r]&&y[e]?y[e].share-y[r].share:0})).length>0?l[0]:null}function a(r,e,n){var a=c.getAPIURL(r),s=new XMLHttpRequest;return s.addEventListener("readystatechange",function(){if(4===this.readyState)if(200==this.status){var r=null;try{r=JSON.parse(this.responseText)}catch(r){n("Couldn't parse response data.")}r&&r.rates?e(r.rates):n("No rates data found in response.")}else n(this.statusText,this.status)}),s.open("GET",a,!0),s.send(null),s}function s(r){var e=0;for(var n in r)e++;return e}function o(r,e){var n={};for(var a in r)e(r[a],a)&&(n[a]=r[a]);return n}function t(r){var e;for(var n in r)(r[n]>e||void 0===e)&&(e=r[n]);return o(r,function(r){return r===e})}function i(){var r={};return[].forEach.call(arguments,function(e){if("object"==typeof e&&null!==e)for(var n in e)r[n]=e[n]}),r}function l(r){for(var e="",n=[],a=/\D+/gi,s=null,o=r.replace(a,"-").split("-");;){if(!(s=a.exec(r)))break;n.push(s[0])}for(var t=0;t<o.length;t++)t===o.length-1&&t>0&&(3!==o[t].length||"."===n[t-1])&&(e+="."),e+=o[t];return parseFloat(e)}function u(r,e){if("number"!=typeof r)return r;var n=r.toString().split("."),a=n[0],s=n[1]||"",o=d(a),t=e-a.length,i="";if(1==t&&(t=2),t>0)for(var l=0;l<t;l++)i+=void 0!==s[l]?s[l]:"0";var u=o;return i.length>0&&(u+="."+i),u}function d(r){if("string"==typeof r||"number"==typeof r){var e=parseInt(r);if("number"!=typeof e||0==e)return r}for(var n="",a=0,s=r.length-1;s>=0;s--)n=r[s]+n,++a>=3&&s>0&&(n=","+n,a=0);return n}function m(r){var e={};for(var n in y){var a=r(y[n],n);!1!==a&&(e[n]=a)}return e}function f(r,e,n){var a=e;return y[r]&&(a=(a=(a=y[r].format).replace(/\%d/g,e)).replace(/\%s/g,!1!==n?r:"")),"string"==typeof a?a.trim():e}var c={getAPIURL:function(r){return"https://api.fixer.io/latest?base="+r},modifierSymbols:[[/k/i,1e3],[/m/i,1e6],[/b/i,1e9],[/t/i,1e12]],modifierWords:[[/thousand/i,1e3],[/million/i,1e6],[/billion/i,1e9],[/trillion/i,1e12]]},h={currencies:["USD","EUR","JPY","GBP","AUD"]};chrome.runtime.onInstalled.addListener(function(r){chrome.storage.local.get(h,function(r){console.log("Existing data",r),chrome.storage.local.set(r,function(){console.log("Updated data.")})})});var y={AUD:{name:"Australian Dollar",share:6.9,symbols:["$","A$"],format:"$%d %s",words:["australian","dollar"]},BGN:{name:"Bulgarian Lev",share:null,symbols:[/lv\b/i,"лв"],format:"%dлв",words:["bulgarian","lev","български","лев"]},BRL:{name:"Brazilian Real",share:1,symbols:["$","R$"],format:"R$%d %s",words:["brazilian","real","reais"]},CAD:{name:"Canadian Dollar",share:5.1,symbols:["$","Can$","C$"],format:"$%d %s",words:["canadian","dollar"]},CHF:{name:"Swiss Franc",share:4.8,symbols:["Fr.","SFr."],format:"%d francs",words:["swiss","franc","franken","franchi"]},CNY:{name:"Chinese Yuan",share:4,symbols:["¥","元","RMB"],format:"¥ %d %s",words:["chinese","yuan","yuán","renminbi","rénmínbì","人民币"]},CZK:{name:"Czech Koruna",share:null,symbols:[/Kč/i],format:"%d Kč",words:["czech","koruna","česká","ceska","koruny","české","ceske"]},DKK:{name:"Danish Krone",share:null,symbols:[/kr\b/i],format:"%s %d kroner",words:["danish","krone","kroner"]},EUR:{name:"Euro",share:37.4,symbols:["€"],format:"€%d %s",words:["euro"]},GBP:{name:"British Pound",share:12.8,symbols:["£"],format:"£%d %s",words:["great","british","pound","sterling","quid"]},HKD:{name:"Hong Kong Dollar",share:1.7,symbols:["$","HK$","元"],format:"$%d %s",words:["hong","kong","dollar","港元","Góng yùn"]},HRK:{name:"Croatian Kuna",share:null,symbols:[/kn\b/i],format:"%d kn",words:["croatian","hrvatska","kuna"]},HUF:{name:"Hungarian Forint",share:null,symbols:[/Ft\b/],format:"%d Ft",words:["hungarian","forint"]},IDR:{name:"Indonesian Rupiah",share:null,symbols:["Rp"],format:"Rp %d",words:["indonesian","rupiah","perak"]},ILS:{name:"Israeli New Shekel",share:null,symbols:["₪"],format:"₪%d %s",words:["israeli","shekel","שֶׁקֶל","חָדָשׁ‎","شيقل","جديد","shēqel","jadīd"]},INR:{name:"Indian Rupee",share:1.1,symbols:["₹"],format:"₹%d %s",words:["indian","rupee","rupiya"]},JPY:{name:"Japanese Yen",share:21.6,symbols:["¥","円","圓"],format:"¥%d %s",words:["japanese","yen","円","圓"]},KRW:{name:"South Korean Won",share:1.7,symbols:["₩"],format:"₩%d %s",words:["south","korea","won","원"]},MXN:{name:"Mexican Peso",share:1.9,symbols:["$","Mex$"],format:"$%d %s",words:["mexican","peso"]},MYR:{name:"Malaysian Ringgit",share:null,symbols:["RM"],format:"RM%d",words:["malaysian","ringgit"]},NOK:{name:"Norwegian Krone",share:1.7,symbols:[/kr\b/i],format:"%s %d kr",words:["norwegian","krone"]},NZD:{name:"New Zealand Dollar",share:2.1,symbols:["$"],format:"$%d %s",words:["zealand","dollar","Tāra","Aotearoa","kiwi"]},PHP:{name:"Philippine Peso",share:null,symbols:["₱"],format:"₱%d %s",words:["philippine","peso","piso","pilipinas"]},PLN:{name:"Polish Zloty",share:null,symbols:["zł",/zl\b/i],format:"%dzł",words:["polish","zloty","złoty"]},RON:{name:"Romanian Leu",share:null,symbols:[/leu\b/i],format:"%d lei",words:["romanian","leu","lei"]},RUB:{name:"Russian Ruble",share:1.1,symbols:["₽","руб"],format:"%d₽",words:["russian","ruble","рубль","рубли́"]},SEK:{name:"Swedish Krona",share:2.2,symbols:[/kr\b/i],format:"%s %d kr",words:["swedish","krona","kronor","spänn","pix","daler","riksdaler","crowns","bagare","bagis","lök"]},SGD:{name:"Singapore Dollar",share:1.8,symbols:["$","S$"],format:"S$%d %s",words:["singapore","dollar"]},THB:{name:"Thai Baht",share:null,symbols:["฿"],format:"฿%d %s",words:["thai","baht","บาท"]},TRY:{name:"Turkish Lira",share:1.4,symbols:["₺"],format:"₺%d %s",words:["turkish","lira","Türk","lirası"]},USD:{name:"US Dollar",share:80.6,symbols:["$","US"],format:"$%d %s",words:["united","states","u.s.","american","dollar","buck"]},ZAR:{name:"South African Rand",share:1,symbols:[/R\b/],format:"R %d",words:["south","african","rand"]}};chrome.runtime.onMessage.addListener(function(r,e,n){"get_currencies"===r.id&&n(y)}),chrome.runtime.onMessage.addListener(function(e,n,a){if("detect_data"===e.id){var s=r(e.data);if("string"==typeof s.currency&&"number"==typeof s.value&&0!==s.value)return chrome.storage.local.get("currencies",function(r){var e=[];r.currencies.forEach(function(r){y[r]&&r!==s.currency&&e.push({code:r,name:y[r].name})}),a({title:f(s.currency,u(s.value,3)),value:s.value,currency:s.currency,list:e})}),!0;a(!1)}}),chrome.runtime.onMessage.addListener(function(r,e,n){if("fill_list"===r.id)return a(r.base,function(e){r.list.forEach(function(n){var a=e[n.code];a&&(n.value=f(n.code,u(r.value*a,3),!1),n.rate=u(a,5))}),n({list:r.list})},function(r,e){n({error:r,code:e})}),!0})}();